Matematické operace se neimplementují všechny stejně složitě. Zatímco aditivní vyřešíme relativně rychle, multiplikativní budou o úroveň těžší, tak mocninné v této kapitole ani nezvládneme a budeme na ně muset počkat až na konec další kapitoly. Začneme tedy operacemi sčítání a odčítání, pak se přesuneme k~násobení a dělení.

\subsection{Aditivní operace}
Součet je operace neomezeného počtu argumentů, pro žádný vrací nulu (neutrální prvek aditivní grupy \cite{RachALG1}), pro jeden vrací tento a pro více se pak jedná o postupné zvětšování výsledku o hodnoty argumentů. Rozdíl potom vyžaduje alespoň jeden argument, v případě zadání pouze tohoto se vrací tnum k němu opačný, v případě více pak součet prvního a opačného tnumu součtu ostatních.

\begin{theorem}[O součtu tnumů]
Nechť $\tnum{x_0}\in\Tnum{x_0}, \tnum{x_1}\in\Tnum{x_1}, \ldots, \tnum{x_n}\in\Tnum{x_n}$ a funkce $\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})$ má předpis
\begin{equation}
\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})(\varepsilon)=\sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right),
\end{equation}
pak $\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})\in\Tnum{\sum_{i=0}^nx_i}$.

\begin{proof}
Předpokládejme $\tnum{x_i}(\varepsilon) + \varepsilon \geq x_i$ a $\tnum{x_i}(\varepsilon) - \varepsilon \leq x_i$ pro $i \in \{0, 1, \ldots , n\}$ a ukažme $\sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) + \varepsilon \geq \sum_{i=0}^nx_i$ a $\sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) - \varepsilon \leq \sum_{i=0}^nx_i$.

Z definice tnumu předpokládáme
\begin{equation}
\begin{aligned}
\tnum{x_0}\left(\frac{\varepsilon}{n+1}\right)+\frac{\varepsilon}{n+1}\geq x_0 &\land \tnum{x_0}\left(\frac{\varepsilon}{n+1}\right)-\frac{\varepsilon}{n+1}\leq x_0,\\
\tnum{x_1}\left(\frac{\varepsilon}{n+1}\right)+\frac{\varepsilon}{n+1}\geq x_1 &\land \tnum{x_1}\left(\frac{\varepsilon}{n+1}\right)-\frac{\varepsilon}{n+1}\leq x_1,\\
\vdots \\
\tnum{x_n}\left(\frac{\varepsilon}{n+1}\right)+\frac{\varepsilon}{n+1}\geq x_n &\land \tnum{x_n}\left(\frac{\varepsilon}{n+1}\right)-\frac{\varepsilon}{n+1}\leq x_n.\\
\end{aligned}
\end{equation}
Sečtěme teď všechny výrazy a získáváme
\begin{equation}
\sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) + \sum_{i=0}^n\frac{\varepsilon}{n+1} \geq \sum_{i=0}^nx_i \land \sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) - \sum_{i=0}^n\frac{\varepsilon}{n+1} \leq \sum_{i=0}^nx_i,
\end{equation}
dále $\sum_{i=0}^n\frac{\varepsilon}{n+1} = \varepsilon$, takže
\begin{equation}
\sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) + \varepsilon \geq \sum_{i=0}^nx_i \land \sum_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{n+1}\right) - \varepsilon \leq \sum_{i=0}^nx_i,
\end{equation}
což jsme chtěli ukázat.
\end{proof}
\end{theorem}

\begin{lispcode}{\texttt{tnum+}}{Funkce na součet tnumů}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{tnum+} (&rest tnums)
  (\textcolor{funkcionalni}{if} (\textcolor{funkcionalni}{null} tnums)
      (\textcolor{moje}{num-to-tnum} 0)
    (\textcolor{funkcionalni}{lambda} (eps)
      (\textcolor{vedlejsi}{let} ((new-eps (\textcolor{matematicke}{/} eps (\textcolor{funkcionalni}{list-length} tnums))))
        (\textcolor{funkcionalni}{apply} \textquotesingle\textcolor{moje}{+} 
               (\textcolor{funkcionalni}{mapcar} (\textcolor{funkcionalni}{lambda} (tnum) 
                         (\textcolor{moje}{tnum-to-num} tnum new-eps))
                       tnums))))))
\end{lispcode}

Odčítání využívá právě dokázané věty a také důsledku \ref{dusl:negace_tnumu}.
\begin{fact}[Rozdíl tnumů]
Nechť $\tnum{x_{-1}}\in\Tnum{x_{-1}}, \tnum{x_{0}}\in\Tnum{x_{0}}, \ldots, \tnum{x_{n}}\in\Tnum{x_{n}}$ a funkce $\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})$ má předpis
\begin{equation}
\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})(\varepsilon)=\tnum{x_{-1}-\sum_{i=0}^nx_n}(\varepsilon)=\tnum{x_{-1}+\left(-\sum_{i=0}^nx_n\right)}(\varepsilon),
\end{equation}
pak $\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})\in\Tnum{x_{-1}-x_0-\ldots -x_n}$.
\end{fact}

Kód odpovídá Lispovskému \texttt{-}, tedy pro jeden argument vrací opačný tnum onoho a pro více argumentů vrací jejich rozdíl.

\begin{lispcode}{\texttt{tnum-}}{Funkce pro rozdíl tnumů, případně opačný tnum}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{tnum-} (tnum1 &rest tnums)
  (\textcolor{funkcionalni}{if} (\textcolor{funkcionalni}{null} tnums)
      (\textcolor{moje}{-tnum} tnum1)
    (\textcolor{moje}{tnum+} tnum1 (\textcolor{moje}{-tnum} (\textcolor{funkcionalni}{apply} \textquotesingle\textcolor{moje}{tnum+} tnums)))))
\end{lispcode}

\subsection{Multiplikativní operace}
Jako první multiplikativní operaci představím převrácení hodnoty tnumu. Je to podobná operace jako opačný tnum, jen jde o jinou inverzi. Protože převrácení pracuje pouze s nenulovými čísly, přidáme do našeho aparátu ještě práci s tnumy nenulových čísel.

\begin{definition}[Nenulový tnum]
Tnum $\tnum{}$, který nikdy nenabývá nulové hodnoty, neboli $(\forall \varepsilon \in (0,1))(\tnum{}(\varepsilon) \neq 0)$ budeme nazývat \textit{nenulový tnum} a budeme ho značit $\tnum{}_\emptyset$.
\end{definition}

Čísla, která nenabývají nuly tedy budeme moci reprezentovat nenulovými tnumy.

\begin{definition}[Bezpečné epsilon]\label{def:bezpecne_epsilon}
K libovolnému $\varepsilon\in (0,1)$ a tnumu $\tnum{x}\in\Tnum{x}, x\neq 0$ uvažujeme číslo $\varepsilon_\emptyset$ tak, že
\begin{enumerate}
\item{$0<\varepsilon_\emptyset\leq\varepsilon$},
\item{$\tnum{x}(\varepsilon_\emptyset) \neq 0$} a
\item{$|\tnum{x}(\varepsilon_\emptyset)| > \varepsilon_\emptyset$}.
\end{enumerate}
a nazýváme jej \textit{bezpečným epsilonem}. Lze použít též symbol $\varepsilon_\emptyset(\tnum{x},\varepsilon)$, pokud z kontextu není jasné, jaký tnum a $\varepsilon$ se uvažují.
\end{definition}

\begin{lemma}[O nenulovém tnumu nenulového čísla]\label{vet:nenul}
Tnum nenulového čísla lze vyčíslit nenulově, čili $(\forall x \in(\mathbb{R}\setminus\{0\}))((\exists \tnum{x}) \rightarrow (\exists \tnum{x}_\emptyset))$. 
\begin{proof}
Vezměme za $\tnum{x}_\emptyset$ funkci $\tnum{}$, která místo $\varepsilon$ dosadí $\varepsilon_\emptyset$, neboli $\tnum{}(\varepsilon) = \tnum{x}(\varepsilon_\emptyset)$. Pak díky podmínce $1$ v definici \ref{def:bezpecne_epsilon} se přesnost nemůže zhoršit a tudíž vyčíslení proběhne v pořádku. Dále díky bodu $2$ ve stejné definici bude vyčíslení nenulové, takže se jedná o nenulový tnum.
\end{proof}
\end{lemma}

Bezpečných epsilonů je nekonečně mnoho, stačí nám najít jediné. Funkce pro jeho výpočet potřebuje tnum a epsilon. To je ve shodě se zavedeným symbolem $\varepsilon_\emptyset(\tnum{x}, \varepsilon)$. Dále musí kvůli kontrole nenulovosti vypočítat i num zadaného tnumu a musí také vracet nové epsilon. Aby se tnum nevyčísloval vícekrát, když už jeho hodnotu známe, vrací funkce i tento num.

\begin{lispcode}{\texttt{get-nonzero-num+eps}}{Funkce pro nalezení přesnosti, při které nebude po aplikaci tnumu nulový výsledek a následné vrácení výsledku i epsilonu}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{get-nonzero-num+eps} (tnum eps)
  (\textcolor{vedlejsi}{let} ((num (\textcolor{moje}{tnum-to-num} tnum eps)))
    (\textcolor{funkcionalni}{if} (\textcolor{funkcionalni}{and} (\textcolor{funkcionalni}{zerop} num) (\textcolor{matematicke}{<=} (\textcolor{matematicke}{abs} num) eps))
        (\textcolor{moje}{get-nonzero-num+eps} tnum (\textcolor{matematicke}{/} eps 10))
      (\textcolor{matematicke}{values} num eps))))
\end{lispcode}

\begin{theorem}[O převráceném tnumu]\label{hyp:prevraceni_tnumu}
Nechť $\tnum{x}\in\Tnum{x},x\neq 0$ a funkce $\tnum{}(\tnum{x})$ má předpis
\begin{equation}
\tnum{}(\tnum{x})(\varepsilon)=/\left[\tnum{x}(\varepsilon_\emptyset(\tnum{x}, (\varepsilon*|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|*(|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|-\varepsilon_\emptyset(\tnum{x}, \varepsilon)))))\right],
\end{equation}
pak $\tnum{}(\tnum{x})\in\Tnum{/x}$.
\begin{proof}

Podle rovnice \ref{rov:def:tnum} platí 
\begin{equation}
\left|\txe-x\right|\leq \varepsilon,
\end{equation}
což lze díky lemmatu \ref{vet:nenul} a předpokladu nenulovosti $x$ přepsat na
\begin{equation}
\left|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))-x\right|\leq \varepsilon,
\end{equation}
díky absolutní hodnotě pak platí
\begin{equation}
\left| x-\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))\right|\leq \varepsilon.
\end{equation}
Nerovnici vydělíme kladným číslem $|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))*x|$
\begin{equation}
\frac{\left| x-\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))\right|}{|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))*x|}\leq \frac{\varepsilon}{|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))*x|}
\end{equation}
a protože $|a|*|b|=|a*b|$, po dvojí aplikaci platí
\begin{equation}
\left|\frac{x-\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))}{\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))*x}\right|\leq \frac{\varepsilon}{|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|*|x|}
\end{equation}
a po roztržení levého výrazu na rozdílné jmenovatele dostáváme
\begin{equation}
\left|\frac{1}{\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))}-\frac{1}{x}\right|\leq \frac{\varepsilon}{|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|*|x|}.
\end{equation}
Dále díky předpokladu $3$ z definice \ref{def:bezpecne_epsilon} $|x|\geq|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|-\varepsilon_\emptyset(\tnum{x}, \varepsilon)$ a proto
\begin{equation}
\left|\frac{1}{\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))}-\frac{1}{x}\right|\leq \frac{\varepsilon}{|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|*(|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|-\varepsilon_\emptyset(\tnum{x}, \varepsilon))},
\end{equation}
takže po úpravě přesnosti dostáváme
\begin{equation}
\left|\frac{1}{\tnum{x}(\varepsilon_\emptyset(\tnum{x}, (\varepsilon * |\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|*(|\tnum{x}(\varepsilon_\emptyset(\tnum{x}, \varepsilon))|-\varepsilon_\emptyset(\tnum{x}, \varepsilon)))))}-\frac{1}{x}\right|\leq \varepsilon.
\end{equation}
\end{proof}
\end{theorem}

\begin{lispcode}{\texttt{/tnum}}{Funkce pro převracení hodnoty tnumu. Pokud je nové epsilon větší nebo stejné, vrací se již vypočtený tnum.}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{/tnum} (tnum)
  (\textcolor{funkcionalni}{lambda} (eps)
    (\textcolor{matematicke}{multiple-value-bind} (num eps0)
        (\textcolor{moje}{get-nonzero-num+eps} tnum eps)
      (\textcolor{vedlejsi}{let*} ((absnum (\textcolor{matematicke}{abs} num))
             (neweps (\textcolor{matematicke}{*} eps absnum (\textcolor{matematicke}{-} absnum eps0))))
        (\textcolor{matematicke}{/} (\textcolor{funkcionalni}{if} (\textcolor{matematicke}{>=} neweps eps) num
             (\textcolor{moje}{get-nonzero-num+eps} tnum neweps)))))))
\end{lispcode}

Násobení bere libovolně mnoho argumentů. Pro žádný vrátí jedničku (jednotka v multiplikativní grupě \cite{RachALG1}), pro jeden vrátí tento a pro více pak jejich součin.

\begin{theorem}[O součinu dvou tnumů]\label{vet:soucin_dvou_tnumu}
Nechť $\tnum{x}\in\Tnum{x},\tnum{y}\in\Tnum{y},x,y\in\mathbb{R}$ a funkce $\tnum{}(\tnum{x},\tnum{y})$ má předpis
\begin{equation}
\tnum{}(\tnum{x},\tnum{y})(\varepsilon)=\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)| + \varepsilon + 1)}\right)*\tnum{y}\left(\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)| + \varepsilon + 1)}\right),
\end{equation}
pak $\tnum{}(\tnum{x},\tnum{y})\in\Tnum{x*y}$.

\begin{proof}
Nejprve si dokážeme dvě nerovnice, které posléze použijeme v těle důkazu.
První nerovnicí je 
\begin{equation}\label{duk:soucin_prvni}
\frac{|y|}{|\tnum{y}(\varepsilon)| + \varepsilon + 1}\leq 1.
\end{equation}
To je ekvivalentní s
\begin{equation}
|y|\leq |\tnum{y}(\varepsilon)|+\varepsilon+1
\end{equation}
a protože $\tnum{y}(\varepsilon)+\varepsilon\geq y$, platí
\begin{equation}
|y|\leq |y|+1,
\end{equation}
což je jistě pravda. 

Druhá nerovnice je
\begin{equation}\label{duk:soucin_druha}
\frac{|\tnum{x}(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon+1|)})|}{|\tnum{x}(\varepsilon)|+\varepsilon+1}\leq 1.
\end{equation}
Ekvivalentní zápis je
\begin{equation}
\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon+1|)}\right)\right|\leq |\tnum{x}(\varepsilon)|+\varepsilon+1
\end{equation}
a protože $\tnum{x}(\varepsilon)+\varepsilon\geq x$, platí
\begin{equation}
\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon+1|)}\right)\right|\leq |x|+1
\end{equation}
a stejným postupem rozepíšeme levou stranu, takže dostáváme
\begin{equation}
|x|+\left|\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon+1)}\right|\leq |x|+1
\end{equation}
a po odečtení $|x|$ zbyde
\begin{equation}
\left|\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon+1)}\right|\leq 1
\end{equation}
což ale platí, protože
\begin{equation}
|\tnum{x} (\varepsilon)|+\varepsilon\geq 0.
\end{equation}

Nyní přejděme k důkazu věty. Aby věta platila, musíme dokázat
\begin{equation}
\left| \tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right) *\tnum{y}\left(\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon +1)}\right) -xy \right|\leq\varepsilon.
\end{equation}
Rozepíšeme proto levou stranu
\begin{equation}
\left| \tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right) *\tnum{y}\left(\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon +1)}\right) -xy \right| =
\end{equation}
přičtením a odečtením členu $\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)} \right)y$ dostáváme
\begin{equation}
\begin{split}=\bigl\vert \tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right) *\tnum{y}\left(\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon +1)}\right) -&
\\-\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)} \right)y + \tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)} \right)y -xy \bigr\vert \leq&
\end{split}
\end{equation}
a z trojúhelníkové nerovnosti a po vytknutí $\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right)\right|$ z prvních dvou členů a $|y|$ z druhých dvou máme
\begin{equation}
\begin{split}
\leq\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right)\right|\left|\tnum{y}\left(\frac{\varepsilon}{2(|\tnum{x}(\varepsilon)|+\varepsilon +1)}\right)-y\right|+\\+|y|\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right)-x\right|\leq
\end{split}
\end{equation}
a po dvojím použití pravidla $|\tnum{x}(\varepsilon)-x|\leq\varepsilon$ získáváme
\begin{equation}
\begin{split}
\leq\left|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right)\right|\left|\frac{\varepsilon}{2}\right|\left|\frac{1}{(|\tnum{x}(\varepsilon)+\varepsilon +1)}\right|+\\+|y|\left|\frac{\varepsilon}{2}\right|\left|\frac{1}{(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right|=
\end{split}
\end{equation}
a zjednodušíme-li zápis pomocí zlomku, dostáváme
\begin{equation}
= \left|\frac{\varepsilon}{2}\right|\frac{|\tnum{x}\left(\frac{\varepsilon}{2(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right)|}{(|\tnum{x}(\varepsilon)|+\varepsilon +1)}+\left|\frac{\varepsilon}{2}\right|\left|\frac{|y|}{(|\tnum{y}(\varepsilon)|+\varepsilon +1)}\right|\leq
\end{equation}
a díky dokázaným nerovnostem \ref{duk:soucin_prvni} a \ref{duk:soucin_druha} pak platí
\begin{equation}
\leq\frac{\varepsilon}{2}+\frac{\varepsilon}{2}=\varepsilon.
\end{equation}
\end{proof}
\end{theorem}

Právě dokázaná věta mluví o součinu dvou tnumů. Zobecnění na konečný počet tnumů by v tomto bodě šlo naprogramovat akumulací. To je ale neefektivní řešení a proto by bylo dobré najít obecnou funkci. Následující vztah není dokázaný, vychází však z tvaru násobení pro dva tnumy.

\begin{fact}[Součin tnumů]\label{vet:soucin_tnumu}
Nechť $\tnum{x_i}\in\Tnum{x_i}, x_i\in\mathbb{R}$ pro $i=0,1,\ldots,n$ a funkce $\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})$ má předpis
\begin{equation}
\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})(\varepsilon)=\prod_{i=0}^n\tnum{x_i}\left(\frac{\varepsilon}{(n+1)*\prod_{j=0, i\neq j}^n(|\tnum{x_j}(\varepsilon)|+\varepsilon +1)}\right),
\end{equation}
pak $\tnum{}(\tnum{x_0},\tnum{x_1},\ldots,\tnum{x_n})\in\Tnum{\prod_{i=0}^nx_i}$.
\end{fact}

Věta mluví o nenulových číslech. Nesnižujeme ale obecnost, protože nula je agresivní prvek a výsledkem násobení čehokoli s nulou je nula, takže se ostatní numy ani nemusejí počítat a výsledek se může vrátit.

Samotná implementace pak využívá pomocnou mapovací funkci, která vypadá trochu složitěji, ale velmi zlepšila porozumění funkci \texttt{tnum*}, o kterou nám teď jde především. Nejprve tedy pomocná

\begin{lispcode}{\texttt{create-list-for-multiplication}}{Pomocná fun\-kce pro násobení}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{create-list-for-multiplication} (tnums eps)
  (\textcolor{vedlejsi}{let} ((result nil)
        (nums
         (\textcolor{funkcionalni}{mapcar} (\textcolor{funkcionalni}{lambda} (tnum) (\textcolor{moje}{tnum-to-num} tnum eps)) tnums)))
    (\textcolor{funkcionalni}{dotimes} (i (\textcolor{funkcionalni}{list-length} tnums) result)
      (\textcolor{vedlejsi}{let} ((actual-eps (\textcolor{matematicke}{/} eps (\textcolor{funkcionalni}{list-length} tnums))))
        (\textcolor{funkcionalni}{dotimes} (j (\textcolor{funkcionalni}{list-length} tnums))
          (\textcolor{funkcionalni}{unless} (\textcolor{matematicke}{=} i j)
            (\textcolor{vedlejsi}{setf} actual-eps (\textcolor{matematicke}{/} actual-eps
                                (\textcolor{matematicke}{+} (\textcolor{funkcionalni}{nth} j nums) eps 1)))))
        (\textcolor{vedlejsi}{setf} result (cons
                      (\textcolor{moje}{tnum-to-num} (\textcolor{funkcionalni}{nth} i tnums) actual-eps)
                      result))))))
\end{lispcode}

a konečně už slíbená hlavní funkce.

\begin{lispcode}{\texttt{tnum*}}{Funkce pro násobení tnumů}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{tnum*} (&rest tnums)
  (\textcolor{funkcionalni}{if} (\textcolor{funkcionalni}{null} tnums)
      (\textcolor{moje}{num-to-tnum} 1)
    (\textcolor{funkcionalni}{lambda} (eps)
      (\textcolor{funkcionalni}{apply} \textquotesingle\textcolor{moje}{*} (\textcolor{moje}{create-list-for-multiplication} tnums eps)))))
\end{lispcode}

Druhou obecnou multiplikativní funkcí je dělení.

\begin{fact}[Podíl tnumů]
Nechť $\tnum{x_i}\in\Tnum{x_i}$ pro $x=-1,0,\ldots ,n$a funkce{\newline}$\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})$ má předpis
\begin{equation}
\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})=\tnum{x_{-1}/\prod_{i=0}^nx_i}=\tnum{x_{-1}*\left(/\prod_{i=0}^nx_i\right)},
\end{equation}
pak $\tnum{}(\tnum{x_{-1}},\tnum{x_0},\ldots,\tnum{x_n})\in\Tnum{x_{-1}/x_0/\ldots /x_n}$.
\end{fact}

Jedná se o tnumovský protějšek funkce \texttt{/}. Pro jeden argument vrací jeho převrácení, pro více pak jejich postupný podíl.

\begin{lispcode}{\texttt{tnum/}}{Funkce pro dělení tnumů}
(\textcolor{funkcionalni}{defun} \textcolor{pojmenovan}{tnum/} (tnum1 &rest tnums)
  (\textcolor{funkcionalni}{if} (\textcolor{funkcionalni}{null} tnums)
      (\textcolor{moje}{/tnum} tnum1)
    (\textcolor{moje}{tnum*} tnum1 (\textcolor{moje}{/tnum} (\textcolor{funkcionalni}{apply} \textquotesingle\textcolor{moje}{tnum*} tnums)))))
\end{lispcode}

Pro tnumy $a, b\in\mathfrak{T}$ existuje tnum $a+b$ a $a*b$. Tyto operace jsou tedy uzavřené. Tnum i v tomto smyslu dobře reprezentuje rekurzivní číslo, rekurzivní čísla totiž tvoří číselné těleso \cite{rice:kompr}.

\subsection{Mocninné operace}
Jak už sem psal v úvodu k této kapitole, na mocnění a odmocňování ještě nemáme v našem systému dostatečný aparát. K implementaci mocninných operací totiž potřebujeme funkce přirozeného logaritmu a exponenciály, které přidáme až v další kapitole.

\begin{lemma}[O mocnině tnumu]\label{vet:mocnina_tnumu}
Mějme $a>0$ a $b\in\mathbb{R}$, pak jejich mocninu $a^b$ lze vyjádřit jako $e^{(b*\mathrm{ln}(a))}$.
\begin{proof}
Kladné číslo $a$ lze vyjádřit jako $e^{(\mathrm{ln}(a))}$, $a^b$ je pak $e^{({\mathrm{ln}(a)})^b}$, což je pak $e^{(b*\mathrm{ln}(a))}$.
\end{proof}
\end{lemma}

Odmocninu potom přijmeme jako mocninu obrácené hodnoty.

\begin{fact}[Odmocnina jako mocnina \cite{tabulky}]\label{fac:odmocnina_tnumu}
Mějme $a, b\in\mathbb{R^+}$. Pak platí
\begin{equation}
\sqrt[a]{b}=b^{(a^{-1})}
\end{equation}
\end{fact}

Operace dokončíme na konci následující kapitoly.

